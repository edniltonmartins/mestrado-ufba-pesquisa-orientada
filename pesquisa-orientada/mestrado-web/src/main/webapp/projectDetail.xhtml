<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
	
	
	<f:metadata>
		<f:viewParam id="projectId" name="projectId" value="#{projectDetailMB.project.id}" required="true"  requiredMessage="#{messages['project.detail.error.projectId']}"  />
		<f:event listener="#{projectDetailMB.init}" type="preRenderView"/>
	</f:metadata>
	
	<h:body>
		<ui:composition template="layout/mainLayout.xhtml">
			<ui:define name="titlePage">Detalhes do Projeto</ui:define>
			
			<ui:define name="content">
				<f:loadBundle var="factoidMsg" basename="br.ufba.dcc.mestrado.computacao.factoid"   />
			
				<section class="container">
					<h:panelGroup id="projectDetailAlert" layout="block" styleClass="alert alert-danger col-md-12" rendered="#{projectDetailMB.project.id eq null}">
						<strong>Vish! </strong>
						<h:message for="projectId"  />
					</h:panelGroup>
				
					<h:panelGroup id="projectTitle" layout="block" styleClass="row">
						<div class="col-md-1">
							<a class="pull-left" href="#">
								<img class="media-object" data-src="holder.js/64x64" src="#{projectDetailMB.project.mediumLogoURL}"  />
							</a>
						</div>
						<div class="col-md-9">
							<h2> <h:outputText value="#{projectDetailMB.project.name}" /> </h2>
						</div>
					</h:panelGroup>
					
					
					<h:panelGroup id="projectSummary" layout="block" styleClass="row">
					
						<h2>Sumário</h2>
						<hr />
						
						<div class="col-md-6">
							<h:panelGroup id="projectDescription" p:itemprop="description" >
								<ui:repeat var="paragraph" value="#{projectDetailMB.projectDescritionParagraphs}">
									<p>
										<h:outputText value="#{paragraph}" /> 
									</p>
								</ui:repeat>
							</h:panelGroup>
							
							<div class="row"></div>
							
							<h4>Tags</h4>
							<h:panelGroup id="tagsPanel" rendered="#{not empty projectDetailMB.project.ohLohTags}">
								<span class="glyphicon glyphicon-tags" style="margin-right: 5px"></span>
								<ui:repeat var="tag" value="#{projectDetailMB.project.ohLohTags}">
									<span class="label label-info"><h:outputText value="#{tag.name}" /></span>      														
								</ui:repeat>      														
							</h:panelGroup>							
						</div>
						
						<div class="col-md-6">
							<h:panelGroup id="projectReferences" layout="block" styleClass="well">
								<h5>Referências</h5>
								
								<dl class="dl-horizontal">
									<dt><a href="#">Links do Projeto:</a></dt>
									<dd style="margin-bottom: .5em;">
										<h:outputLink title="Homepage" value="#{projectDetailMB.project.homepageURL}"
											rendered="#{not empty projectDetailMB.project.homepageURL}">
											<span class="glyphicon glyphicon-new-window"></span>
											Homepage
										</h:outputLink>
										<br />
										<h:outputLink title="Download" value="#{projectDetailMB.project.downloadURL}" 
											rendered="#{not empty projectDetailMB.project.downloadURL}">
											<span class="glyphicon glyphicon-new-window"></span>
											Download
										</h:outputLink>
										
									</dd>
									
									<dt><a href="#">Links para Código:</a></dt>
									<dd style="margin-bottom: .5em;">
									
										<h:panelGroup  layout="block" rendered="#{projectDetailMB.enlistmentCount eq 1}">
											<ui:repeat var="enlistment" value="#{projectDetailMB.enlistmentList}" >
												<h:link value="#{enlistment.ohLohRepository.url}" >
													<h:outputText value="#{enlistment.ohLohRepository.url}" />
												</h:link>
											</ui:repeat>
										</h:panelGroup>			
																	
										<h:panelGroup  layout="block" rendered="#{projectDetailMB.enlistmentCount > 1}">
											<h:outputText value="#{projectDetailMB.enlistmentCount} links" />
										</h:panelGroup>		
																		
										<h:panelGroup  layout="block" rendered="#{empty projectDetailMB.enlistmentList}">											
											<h:outputText  value="Sem links" />
										</h:panelGroup>			
																
									</dd>
									
									<dt><a href="#">Licenças:</a></dt>	
									<dd style="margin-bottom: .5em;">
										<h:panelGroup layout="block" rendered="#{not empty projectDetailMB.project.ohLohLicenses}">
											<ui:repeat var="license" value="#{projectDetailMB.project.ohLohLicenses}">
												<h:link>
													<h:outputText value="#{license.niceName}" />
												</h:link>
												<br />
											</ui:repeat>
										</h:panelGroup>
										
										<h:panelGroup layout="block" rendered="#{empty projectDetailMB.project.ohLohLicenses}">
											<h:outputText value="Sem Licenças de Uso" />
										</h:panelGroup>																		
									</dd>						
								</dl>
							</h:panelGroup>
						</div>
					</h:panelGroup>
					
					<h:panelGroup id="nutshelPanel" layout="block" styleClass="row" style="margin-top: 20px">
						<div class="col-md-6">
							
							
							
							<h:panelGroup id="projectNutshelFull" layout="block" styleClass="well" rendered="#{not empty projectDetailMB.factoidList}"  >
								<h5>Em resumo, <h:outputText value="#{projectDetailMB.project.name}" />...</h5>
								
								
								<ul class="list-unstyled" style="padding-left: 30px;">
									<li>
										...
										<div class="indent" style="margin-left: 1em; margin-top: -1.4em;">
											<h:outputText  value="tem um total de #{projectDetailMB.project.ohLohAnalysis.totalCommitCount} commits
											feitos por #{projectDetailMB.project.ohLohAnalysis.totalContributorCount} desenvolvedores, representando
											#{projectDetailMB.project.ohLohAnalysis.totalCodeLines} linhas de código
											" />
										</div>
									</li>
									
									<li>
										...
										<div class="indent" style="margin-left: 1em; margin-top: -1.4em;">
											<h:outputText value="é escrito principalmente em #{projectDetailMB.project.ohLohAnalysis.mainLanguageName}"  />
										</div>
									</li>
								
									<ui:repeat var="factoid" value="#{projectDetailMB.project.ohLohAnalysis.ohLohFactoids}">
										<li >
											...
											<div class="indent" style="margin-left: 1em; margin-top: -1.4em;">
												<c:set var="key" value="factoid.title.#{factoid.type}" />
												<h:outputText value="#{factoidMsg[key]}" />																								
											</div>
										</li>
									</ui:repeat>
								</ul>
							</h:panelGroup>
							
							<h:panelGroup id="projectNutshelEmpty" layout="block" styleClass="well" rendered="#{empty projectDetailMB.factoidList}"  >
								<h5>Não há análises para o projeto <h:outputText value="#{projectDetailMB.project.name}" />...</h5>
							</h:panelGroup>
						</div>
						
						<div class="col-md-6">
							<h:panelGroup id="projectLanguages" layout="block" rendered="#{projectDetailMB.project.ohLohAnalysis != null}" >
								<h:link>
									<h4>Linguagens</h4>
								</h:link>
								<div class="float_left col-md-3" style="padding-right: 10px">
									<img src="#{projectDetailMB.analysisLanguages.graphURL}?height=75&amp;width=75"  />
								</div>
								<div class="float right col-md-9">
									<table class="table table-striped unstyled pull-left" style="width: 300px" >
										<tbody >
											<ui:repeat var="languageAnalysis" value="#{projectDetailMB.analysisLanguages.content}" >
												<tr class="pull-left" style="width: 150px;">
													<td style="width: 120px">
														<div class="pull-left" style="width:5px; height: 12px; margin-top: 5px; margin-right: 10px; background-color:##{languageAnalysis.color}">
														</div>
														<h:outputText  value="#{languageAnalysis.ohLohLanguage.niceName}"  rendered="#{languageAnalysis.languageId != null}" />
														<h:outputText  value="Outras"  rendered="#{languageAnalysis.languageId eq null}" />
													</td>
													<td style="width: 20px">
														<h:outputText value="#{languageAnalysis.percentage}%" />
													</td>
												</tr>
											</ui:repeat>
										</tbody>
									</table>
								</div>
							</h:panelGroup>
						</div>
					
					</h:panelGroup>
					
					<h:panelGroup id="activityPanel" layout="block" styleClass="row">
					
						<h2>Atividade</h2>
						<hr />
						
					</h:panelGroup>
					
					<h:panelGroup id="communityPanel" layout="block" styleClass="row" style="margin-bottom: 20px">
					
						<h2>Comunidade</h2>
						<hr />
						
						
						<div class="col-md-4">
							<h:outputLink value="projectReviews.jsf" >
								<f:param name="projectId" value="#{projectDetailMB.project.id}" />
								<h5>Avaliações</h5>
							</h:outputLink>
							<p>
								<h:outputText 
									rendered="#{projectDetailMB.overallPreferenceCount eq 1}"
									value="#{projectDetailMB.overallPreferenceCount} pessoa avaliou este projeto" />
									
								<h:outputText 
									rendered="#{projectDetailMB.overallPreferenceCount > 1}"
									value="#{projectDetailMB.overallPreferenceCount} pessoas avaliaram este projeto" />
									
								<h:outputText 
									rendered="#{projectDetailMB.overallPreferenceCount eq 0}"
									value="Nenhum usuário avaliou ainda este projeto" /> 
							</p>
							<p>
								<div class="rateit" data-rateit-readonly="true"
									data-rateit-min="0" data-rateit-max="10"
									data-rateit-value="#{projectDetailMB.averageOverallPreferenceValue}" data-rateit-ispreset="true"  />
							</p>
							<h:link outcome="newProjectReview">
								<f:param name="projectId" value="#{projectDetailMB.project.id}" />
								Avalie você também este projeto
							</h:link>
							
						</div>
						
						<div class="col-md-4">
						</div>
						
						<div class="col-md-4">
						</div>
						
					</h:panelGroup>
				
				</section>
				
			</ui:define>
			
		</ui:composition>
	</h:body>
</html>